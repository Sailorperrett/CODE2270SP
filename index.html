<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CODE 2270 - BIM</title>
    <link rel="stylesheet" href="css/style.css">

<div class="titleBlock">
    <h1>UNSW CODE2270 BIM PLAN</h1><br>
    <h2>Sailor Perrett</h2>
</div>


    <title>three.js webgl - IFCLoader</title>
    <meta charset="utf-8" />
    <meta
            name="viewport"
            content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"

<body>



<script type="importmap">
			{
				"imports": {
					"three": "https://unpkg.com/three@0.138.3/build/three.module.js"
				}
			}
		</script>

<script type="module">

    import * as THREE from 'three';
    import { OrbitControls } from 'https://unpkg.com/three@0.138.3/examples/jsm/controls/OrbitControls.js';
    import { IFCLoader } from 'https://unpkg.com/three@0.138.3/examples/jsm/loaders/IFCLoader.js';

    let scene, camera, renderer;

    init();

    function init() {

        //Scene
        scene = new THREE.Scene();
        scene.background = new THREE.Color( 0xffffff );

        //Camera
        camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 0.1, 1000 );
        camera.position.z = - 20;
        camera.position.y = 20;
        camera.position.x = 20;

        //Lights
        const directionalLight1 = new THREE.DirectionalLight( 0xff0000, 0.8 );
        directionalLight1.position.set( 1, 1, 1 );
        scene.add( directionalLight1 );

        const directionalLight2 = new THREE.DirectionalLight( 0xffffff, 0.8 );
        directionalLight2.position.set( - 1, 0.5, - 1 );
        scene.add( directionalLight2 );

        const ambientLight = new THREE.AmbientLight( 0xffffee, 0.25 );
        scene.add( ambientLight );

        //Setup IFC Loader
        const ifcLoader = new IFCLoader();
        ifcLoader.ifcManager.setWasmPath( './model/' );
        ifcLoader.load( 'model/floorplate.ifc', function ( model ) {

            scene.add( model.mesh );
            render();

        } );

        const highlightMaterial = new THREE.MeshPhongMaterial( { color: 0x0000ff, depthTest: false, transparent: true, opacity: 0.1 } );

        function selectObject( event ) {

            if ( event.button != 0 ) return;

            const mouse = new THREE.Vector2();
            mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;
            mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;

            const raycaster = new THREE.Raycaster();
            raycaster.setFromCamera( mouse, camera );

            const intersected = raycaster.intersectObjects( scene.children, false );
            if ( intersected.length ) {

                const found = intersected[ 0 ];
                const faceIndex = found.faceIndex;
                const geometry = found.object.geometry;
                const id = ifcLoader.ifcManager.getExpressId( geometry, faceIndex );

                const modelID = found.object.modelID;
                ifcLoader.ifcManager.createSubset( { modelID, ids: [ id ], scene, removePrevious: true, material: highlightMaterial } );
                const props = ifcLoader.ifcManager.getItemProperties( modelID, id, true );
                console.log( props );
                renderer.render( scene, camera );

            }

        }

        window.onpointerdown = selectObject;

        //Renderer
        renderer = new THREE.WebGLRenderer( { antialias: true	} );
        renderer.setSize( window.innerWidth, window.innerHeight );
        renderer.setPixelRatio( window.devicePixelRatio );
        document.body.appendChild( renderer.domElement );

        //Controls
        const controls = new OrbitControls( camera, renderer.domElement );
        controls.addEventListener( 'change', render );

        window.addEventListener( 'resize', onWindowResize );

        render();

    }

    function onWindowResize() {

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();
        renderer.setSize( window.innerWidth, window.innerHeight );

        render();

    }

    function render() {

        renderer.render( scene, camera );

    }
</script>


<div class= "BIM SHEETS">
    <h3>SHEETS </h3>
     <p>CLICK HERE TO OPEN ALL <a href="SHEETS.pdf">BIM SHEETS</a><p>

</div>
<embed src="A0 Coverpage.jpg" width="1100px" height="800px" />
<embed src="A1 Siteplan.jpg" width="1100px" height="800px" />
<embed src="A2 Floorplan.jpg" width="1100px" height="800px" />
<embed src="A3 East West Section.jpg" width="1100px" height="800px" />
<embed src="A4 North South Section.jpg" width="1100px" height="800px" />
<embed src="A5 East West Elevation.jpg" width="1100px" height="800px" />
<embed src="A6 North South Elevation.jpg" width="1100px" height="800px" />
<embed src="A7 Front Back View.jpg" width="1100px" height="800px" />
<embed src="A8 East West View.jpg" width="1100px" height="800px" />
<embed src="A9 Environmental Analysis.jpg" width="1100px" height="800px" />
<embed src="A10 Construction Sequencing Table.jpg" width="1100px" height="800px" />
<embed src="A11 Phase 1.jpg" width="1100px" height="800px" />
<embed src="A12 Phase 2.jpg" width="1100px" height="800px" />
<embed src="A13 Phase 3.jpg" width="1100px" height="800px" />
<embed src="A14 Phase 4.jpg" width="1100px" height="800px" />
<embed src="A15 Phase 5.jpg" width="1100px" height="800px" />
<embed src="A16 Clash Report Overview.jpg" width="1100px" height="800px" />
<embed src="A17 Resolved Clashes.jpg" width="1100px" height="800px" />
<embed src="A18 Quantity Takeoff.jpg" width="1100px" height="800px" />
<embed src="A19 Cost Scheduele.jpg" width="1100px" height="800px" />

</body>
</html>